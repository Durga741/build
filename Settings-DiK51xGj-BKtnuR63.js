import{q as M,s as I,t as P,v as y,o as E,w as r,a as R,u as j,b as F,j as s,d as x,M as L,r as v,c as B,P as k,x as C,y as T,L as w,B as $,z as H,A as V,l as q,h as z,G as f,H as G,J as N,F as O,K as U}from"./strapi-BDL4OyES.js";import{u as Q,c as _,g as n}from"./getTrad-BCVqzyys-DMFQkwDM.js";const D=t=>t.name!==void 0,J=M().shape({restrictedAccess:I(),password:P().when("restrictedAccess",(t,o)=>t?o.required(y.required.id).min(8).matches(/[a-z]/,"components.Input.error.contain.lowercase").matches(/[A-Z]/,"components.Input.error.contain.uppercase").matches(/\d/,"components.Input.error.contain.number"):o)}),K=E(r.Action)`
  svg {
    height: 1.6rem;
    width: 1.6rem;
    path {
      fill: ${({theme:t})=>t.colors.neutral600};
    }
  }
`,W=({data:t,onSubmit:o})=>{const{formatMessage:e}=j(),[c,l]=v.useState(!1),{allowedActions:u}=B(k);return s.jsx(C,{enableReinitialize:!0,initialValues:{restrictedAccess:t?.documentationAccess.restrictedAccess||!1,password:""},onSubmit:o,validationSchema:J,children:({handleSubmit:g,values:a,handleChange:p,errors:i,setFieldTouched:h,setFieldValue:m,setFieldError:d,dirty:A})=>s.jsxs(T,{noValidate:!0,onSubmit:g,children:[s.jsx(w.Header,{title:e({id:n("plugin.name"),defaultMessage:"Documentation"}),subtitle:e({id:n("pages.SettingsPage.header.description"),defaultMessage:"Configure the documentation plugin"}),primaryAction:s.jsx($,{type:"submit",startIcon:s.jsx(H,{}),disabled:!A&&u.canUpdate,children:e({id:n("pages.SettingsPage.Button.save"),defaultMessage:"Save"})})}),s.jsx(w.Content,{children:s.jsx(V,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,children:s.jsxs(q,{direction:"column",alignItems:"stretch",gap:4,children:[s.jsx(z,{variant:"delta",tag:"h2",children:e({id:"global.settings",defaultMessage:"Settings"})}),s.jsxs(f.Root,{gap:4,children:[s.jsx(f.Item,{col:6,s:12,direction:"column",alignItems:"stretch",children:s.jsxs(r.Root,{name:"restrictedAccess",hint:e({id:n("pages.SettingsPage.toggle.hint"),defaultMessage:"Make the documentation endpoint private"}),children:[s.jsx(r.Label,{children:e({id:n("pages.SettingsPage.toggle.label"),defaultMessage:"Restricted Access"})}),s.jsx(G,{checked:a.restrictedAccess,onChange:()=>{a.restrictedAccess===!0&&(m("password","",!1),h("password",!1,!1),d("password",void 0)),m("restrictedAccess",!a.restrictedAccess,!1)},onLabel:"On",offLabel:"Off"}),s.jsx(r.Hint,{})]})}),a.restrictedAccess&&s.jsx(f.Item,{col:6,s:12,direction:"column",alignItems:"stretch",children:s.jsxs(r.Root,{name:"password",error:i.password?e({id:i.password,defaultMessage:i.password}):void 0,children:[s.jsx(r.Label,{children:e({id:"global.password",defaultMessage:"Password"})}),s.jsx(N,{placeholder:"**********",type:c?"text":"password",value:a.password,onChange:p,endAction:s.jsx(K,{onClick:S=>{S.stopPropagation(),l(b=>!b)},label:e(c?{id:"Auth.form.password.show-password",defaultMessage:"Show password"}:{id:"Auth.form.password.hide-password",defaultMessage:"Hide password"}),children:c?s.jsx(O,{}):s.jsx(U,{})})}),s.jsx(r.Error,{})]})})]})]})})})]})})},Y=()=>{const{toggleNotification:t}=R(),{formatMessage:o}=j(),{_unstableFormatAPIError:e,_unstableFormatValidationErrors:c}=F(),{data:l,isError:u,isLoading:g,isFetching:a}=Q(),[p]=_(),i=async(h,m)=>p({body:h}).unwrap().then(()=>{t({type:"success",message:o({id:n("notification.update.success"),defaultMessage:"Successfully updated settings"})})}).catch(d=>{D(d)&&d.name==="ValidationError"&&t({type:"danger",message:e(d)})});return g||a?s.jsx(x.Loading,{}):u?s.jsx(x.Error,{}):s.jsx(L,{children:s.jsx(W,{data:l,onSubmit:i})})};export{Y as SettingsPage};
